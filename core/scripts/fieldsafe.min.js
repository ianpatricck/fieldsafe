class Mask{constructor(e=null){if(this.formStatus=[],e){if("object"!=typeof e)throw new Error("form element on constructor is not a object");this.#e(e)}}#e(e){for(let t of e)t.getAttribute("fs-mask")&&this.#t(t,t.getAttribute("fs-mask"))}#t(e,t){e.maxLength=t.length,e.addEventListener("keyup",(s=>{if(""!==e.value.trim()){let s=t.split(""),r=e.value.split("");r=r.filter((e=>{if(!s.includes(e)&&""!==e.trim())return e}));let a=[];s.forEach((e=>{if("#"!==e)a.push(e);else{const e=r.find((e=>e));r.shift(),a.push(e)}})),e.value=a.join("")}}))}fmatch(e,t,s){if(!e)throw new Error("input param is not defined");if(!t)throw new Error("match param is not defined");let{success:r,failure:a,response:n}=s;if(!r||!a||!n)throw new Error("success, failure or response fields are undefined");try{return e.addEventListener("keyup",(s=>{if(""!==e.value.trim()){if("string"==typeof t)if(REGEX[t].test(e.value)){let t={name:e.name,success:!0,message:a};this.formStatus=this.formStatus.filter((e=>e.name!==t.name)),this.formStatus.push(t),"string"==typeof n&&(document.querySelector(n).innerText=r)}else{let t={name:e.name,success:!1,message:a};this.formStatus=this.formStatus.filter((e=>e.name!==t.name)),this.formStatus.push(t),"string"==typeof n&&(document.querySelector(n).innerText=a)}}else document.querySelector(n).innerText=""})),this}catch(t){throw new Error("input param is not valid: "+typeof e)}}validate(e=null){if(!e)return this.formStatus;e(this.formStatus)}}const REGEX={SPECIAL_CHARS:/[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/,EMAIL:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,CPF:/^\d{3}\.\d{3}\.\d{3}-\d{2}$/,CNPJ:/^\d{2}\.\d{3}\.\d{3}\/\d{4}\-\d{2}$/,ZIPCODE_BR:/^\d{5}\-\d{3}$/,ZIPCODE_AR:/^\d{4}$/,ZIPCODE_US:/^\d{5}(?:[-\s]\d{4})?$/,ZIPCODE_CA:/^[A-Z]\d[A-Z]\s\d[A-Z]\d$/,PHONE_BR:/^(?:(?:\+|00)?(55)\s?)?(?:\(?([1-9][0-9])\)?\s?)(?:((?:9\s?\d|[2-9])\d{3})\-?(\d{4}))$/,PHONE_US:/^(\([1-9][0-9][0-9]\) |[0-9]{3}-)[0-9]{3}-[0-9]{4}$/,PHONE_CA:/^\s*(?:\+?(\d{1,3}))?[-. (]*(\d{3})[-. )]*(\d{3})[-. ]*(\d{4})(?: *x(\d+))?\s*$/,PHONE_AR:/(?<=\s|:)\(?(?:(0?[1-3]\d{1,2})\)?(?:\s|-)?)?((?:\d[\d-]{5}|15[\s\d-]{7})\d+)/,MasterCard:/^((5(([1-2]|[4-5])[0-9]{8}|0((1|6)([0-9]{7}))|3(0(4((0|[2-9])[0-9]{5})|([0-3]|[5-9])[0-9]{6})|[1-9][0-9]{7})))|((508116)\\d{4,10})|((502121)\\d{4,10})|((589916)\\d{4,10})|(2[0-9]{15})|(67[0-9]{14})|(506387)\\d{4,10})/,Visa:/^4[0-9]{15}$/,AmericanExpress:/^3[47][0-9]{13}$/,ELO:/^4011(78|79)|^43(1274|8935)|^45(1416|7393|763(1|2))|^50(4175|6699|67[0-6][0-9]|677[0-8]|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9])|^627780|^63(6297|6368|6369)|^65(0(0(3([1-3]|[5-9])|4([0-9])|5[0-1])|4(0[5-9]|[1-3][0-9]|8[5-9]|9[0-9])|5([0-2][0-9]|3[0-8]|4[1-9]|[5-8][0-9]|9[0-8])|7(0[0-9]|1[0-8]|2[0-7])|9(0[1-9]|[1-6][0-9]|7[0-8]))|16(5[2-9]|[6-7][0-9])|50(0[0-9]|1[0-9]|2[1-9]|[3-4][0-9]|5[0-8]))/,HiperCard:/^606282|^3841(?:[0|4|6]{1})0/,IPV4:/^((?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])[.]){3}(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,IPV6:/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/};class Sanitization{add_slashes(e){return e.split("").map((e=>(/'|"|\\|`|Â´$/.test(e)&&(e="\\"+e),e))).join("")}escape_special_chars(e){return e.split("").map((e=>(REGEX.SPECIAL_CHARS.test(e)&&(e="\\"+e),e))).join("")}remove_numeric(e){return e.split("").map((e=>((Number(e)||0==e)&&(e=""),e))).join("")}remove_special_chars(e){return e.split("").map((e=>(REGEX.SPECIAL_CHARS.test(e)&&(e=""),e))).join("")}}class Validation{email(e){return REGEX.EMAIL.test(e)}password(e,t){if(!t||"object"!=typeof t)throw new Error("options object must exist");{if(0===Object.keys(t).length)throw new Error("options object is empty");const s=["numbers","special_chars","lowercase_quantity","uppercase_quantity","min","max"];for(let e of Object.keys(t))if(!s.includes(e))throw new Error(`key ${e} is not allowed`);const{numbers:r,special_chars:a,lowercase_quantity:n,uppercase_quantity:i,min:o,max:u}=t;if(r&&!0===r&&!e.match(/[0-9]/g))return{success:!1,status:1,message:"Password must contain at least one number"};if(a&&!0===a){if(!REGEX.SPECIAL_CHARS.test(e))return{success:!1,status:2,message:"Password must contain at least one special character"}}if(n&&!isNaN(n)){if("boolean"==typeof n)throw new Error("lowercase_quantity must be a number");const t=REGEX.SPECIAL_CHARS;if(e.split("").map((e=>e==e.toLowerCase()&&isNaN(e)&&!t.test(e)?e:"")).join("").length<n)return{success:!1,status:3,message:`The password must contain at least ${Number(n)} lowercase letter`}}if(i&&!isNaN(i)){if("boolean"==typeof i)throw new Error("uppercase_quantity must be a number");const t=REGEX.SPECIAL_CHARS;if(e.split("").map((e=>e==e.toUpperCase()&&isNaN(e)&&!t.test(e)?e:"")).join("").length<i)return{success:!1,status:4,message:`The password must contain at least ${Number(i)} uppercase letter`}}if(o&&!isNaN(o)&&e.length<o)return{success:!1,status:5,message:`Password must be at least ${o} characters long`};if(u&&!isNaN(u)&&e.length>u)return{success:!1,status:6,message:`The password must have a maximum of ${u} characters`}}return!0}cpf(e){return REGEX.CPF.test(e)}cnpj(e){return REGEX.CNPJ.test(e)}zipcode_br(e){return REGEX.ZIPCODE_BR.test(e)}zipcode_ar(e){return REGEX.ZIPCODE_AR.test(e)}zipcode_us(e){return REGEX.ZIPCODE_US.test(e)}zipcode_ca(e){return REGEX.ZIPCODE_CA.test(e)}phone_br(e){return REGEX.PHONE_BR.test(e)}phone_us(e){return REGEX.PHONE_US.test(e)}phone_ca(e){return REGEX.PHONE_CA.test(e)}phone_ar(e){return REGEX.PHONE_AR.test(e)}mastercard(e){return REGEX.MasterCard.test(e)}visa(e){return REGEX.Visa.test(e)}american_express(e){return REGEX.AmericanExpress.test(e)}elo(e){return REGEX.ELO.test(e)}hiper_card(e){return REGEX.HiperCard.test(e)}ipv4(e){return REGEX.IPV4.test(e)}ipv6(e){return REGEX.IPV6.test(e)}}
